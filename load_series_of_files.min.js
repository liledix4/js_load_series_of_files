import{readTextFile}from"../js_xhr_ajax/xhr_ajax.js";let fileData=[];export function loadSeriesOfFiles(e,l,t){readTextFile({url:e},(n=>{let i=JSON.parse(n);const f=e.match(/.*\//)[0];let s=null;if(s={file:e,subfiles:null,content:null},i[l]&&(i[l].forEach((e=>{const t=f+e;null!==s&&(null===s.subfiles&&(s.subfiles=[]),s.subfiles.push(t)),loadSeriesOfFiles(t,l)})),delete i[l]),Object.keys(i).length>0&&(s.content=i),null!==s&&fileData.push(s),t)return checkIfFilesAreLoaded(t)}))}export function checkIfFilesAreLoaded(e){let l=[],t=!1;function n(e){0===l.filter((l=>l===e)).length&&l.push(e)}function i(){l.length;setTimeout((()=>{checkIfFilesAreLoaded(e)}),2e3)}0!==fileData.length?(fileData.forEach((e=>{n(e.file),null!==e.subfiles&&e.subfiles.forEach((e=>{n(e)}))})),t=l.every((e=>{const l=fileData.filter((l=>l.file===e));return 0!==l.length&&(1===l.length&&null!==l[0].content)})),!0===t?(l.length,e(fileData)):!1===t&&i()):i()}